{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/Users/mahad/Local Disk/FYP-FE/helping-hands/lib/cookieChecker.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatchUser, useData } from \"./userData.js\";\nimport cookie from \"js-cookie\";\nimport { useQuery, useMutation, useLazyQuery } from \"@apollo/react-hooks\";\nimport { INITIALIZATION_QUERY, DONOR_INFO, ORGANIZATION_INFO } from \"./queries\";\nimport { useRouter } from \"next/router\";\nexport default function CookieChecker(props) {\n  _s();\n\n  var user = useData();\n  var dispatch = useDispatchUser();\n  var token = cookie.get(\"token\");\n  var router = useRouter();\n\n  var _useState = useState(false),\n      loggedIn = _useState[0],\n      setLoginIn = _useState[1];\n\n  var _useLazyQuery = useLazyQuery(INITIALIZATION_QUERY, {\n    fetchPolicy: \"no-cache\"\n  }),\n      _useLazyQuery2 = _slicedToArray(_useLazyQuery, 2),\n      getData = _useLazyQuery2[0],\n      data = _useLazyQuery2[1].data;\n\n  var _useLazyQuery3 = useLazyQuery(DONOR_INFO, {\n    fetchPolicy: \"no-cache\"\n  }),\n      _useLazyQuery4 = _slicedToArray(_useLazyQuery3, 2),\n      getDonor = _useLazyQuery4[0],\n      donorInfo = _useLazyQuery4[1].data;\n\n  var _useLazyQuery5 = useLazyQuery(ORGANIZATION_INFO, {\n    fetchPolicy: \"no-cache\"\n  }),\n      _useLazyQuery6 = _slicedToArray(_useLazyQuery5, 2),\n      getOrganization = _useLazyQuery6[0],\n      organizationInfo = _useLazyQuery6[1].data;\n\n  useEffect(function () {\n    console.log(\"called\");\n\n    if (user[\"id\"] && token && data) {\n      setLoginIn(true);\n      console.log(\"im hereeeeeee\"); // if (data.me.role.name == \"Donor\") {\n      //   router.push(\"/account\");\n      // }\n      // if (data.me.role.name == \"Organization\") {\n      //   router.push(\"/account_o\");\n      // }\n    }\n\n    if (token && !data) {\n      console.log(\"im here\");\n      getData();\n    }\n\n    if (data && (!donorInfo || !organizationInfo) && !user[\"id\"]) {\n      console.log(\"say hello\");\n      console.log(data, \"data\"); // console.log(data.me.id);\n\n      if (data.me.role.name == \"Donor\") {\n        getDonor({\n          variables: {\n            fields: {\n              user: data.me.id\n            }\n          }\n        });\n      }\n\n      if (data.me.role.name == \"Organization\") {\n        getOrganization({\n          variables: {\n            fields: {\n              user: data.me.id\n            }\n          }\n        });\n      }\n    }\n\n    if (!user[\"id\"] && !token) {\n      setLoginIn(false); // router.push(\"/login\");\n    }\n\n    if (donorInfo && !user[\"id\"]) {\n      console.log(donorInfo); //   if (donorInfo[\"donors\"]) {\n      //     if (!donorInfo.donors.length) {\n      //       router.push(\"/login\");\n      //     } else {\n\n      dispatch({\n        type: \"LOGIN\",\n        payload: donorInfo.donors[0]\n      });\n      router.push(\"/account\"); //     }\n      //   } else {\n      //     router.push(\"/login\");\n      //   }\n      // router.push(\"/\");\n    }\n\n    if (organizationInfo && !user[\"id\"]) {\n      console.log(organizationInfo); //   if (organizationInfo[\"organizations\"]) {\n      //     if (!organizationInfo.organizations.length) {\n      //       router.push(\"/login\");\n      //     } else {\n      //       console.log(organizationInfo);\n\n      dispatch({\n        type: \"LOGIN\",\n        payload: organizationInfo.organizations[0]\n      });\n      router.push(\"/account_o\"); //     }\n      //   } else {\n      //     router.push(\"/login\");\n      //   }\n      // router.push(\"/\");\n    }\n  }, [user, data, donorInfo, organizationInfo, token]);\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 10\n    }\n  }, props.childeren);\n}\n\n_s(CookieChecker, \"NNns++XW/dP0x26fCVyyjGo7jc4=\", false, function () {\n  return [useData, useDispatchUser, useRouter, useLazyQuery, useLazyQuery, useLazyQuery];\n});\n\n_c = CookieChecker;\n\nvar _c;\n\n$RefreshReg$(_c, \"CookieChecker\");","map":{"version":3,"sources":["/Users/mahad/Local Disk/FYP-FE/helping-hands/lib/cookieChecker.js"],"names":["React","useEffect","useState","useDispatchUser","useData","cookie","useQuery","useMutation","useLazyQuery","INITIALIZATION_QUERY","DONOR_INFO","ORGANIZATION_INFO","useRouter","CookieChecker","props","user","dispatch","token","get","router","loggedIn","setLoginIn","fetchPolicy","getData","data","getDonor","donorInfo","getOrganization","organizationInfo","console","log","me","role","name","variables","fields","id","type","payload","donors","push","organizations","childeren"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useDispatchUser, useData } from \"./userData.js\";\nimport cookie from \"js-cookie\";\nimport { useQuery, useMutation, useLazyQuery } from \"@apollo/react-hooks\";\nimport { INITIALIZATION_QUERY, DONOR_INFO, ORGANIZATION_INFO } from \"./queries\";\nimport { useRouter } from \"next/router\";\n\nexport default function CookieChecker(props) {\n  const user = useData();\n  const dispatch = useDispatchUser();\n  const token = cookie.get(\"token\");\n  const router = useRouter();\n  const [loggedIn, setLoginIn] = useState(false);\n  const [getData, { data }] = useLazyQuery(INITIALIZATION_QUERY, {\n    fetchPolicy: \"no-cache\",\n  });\n\n  const [getDonor, { data: donorInfo }] = useLazyQuery(DONOR_INFO, {\n    fetchPolicy: \"no-cache\",\n  });\n  const [getOrganization, { data: organizationInfo }] = useLazyQuery(\n    ORGANIZATION_INFO,\n    {\n      fetchPolicy: \"no-cache\",\n    }\n  );\n  useEffect(() => {\n    console.log(\"called\");\n\n    if (user[\"id\"] && token && data) {\n      setLoginIn(true);\n      console.log(\"im hereeeeeee\");\n      // if (data.me.role.name == \"Donor\") {\n      //   router.push(\"/account\");\n      // }\n      // if (data.me.role.name == \"Organization\") {\n      //   router.push(\"/account_o\");\n      // }\n    }\n    if (token && !data) {\n      console.log(\"im here\");\n\n      getData();\n    }\n    if (data && (!donorInfo || !organizationInfo) && !user[\"id\"]) {\n      console.log(\"say hello\");\n      console.log(data, \"data\");\n      // console.log(data.me.id);\n      if (data.me.role.name == \"Donor\") {\n        getDonor({\n          variables: {\n            fields: {\n              user: data.me.id,\n            },\n          },\n        });\n      }\n      if (data.me.role.name == \"Organization\") {\n        getOrganization({\n          variables: {\n            fields: {\n              user: data.me.id,\n            },\n          },\n        });\n      }\n    }\n    if (!user[\"id\"] && !token) {\n      setLoginIn(false);\n      // router.push(\"/login\");\n    }\n    if (donorInfo && !user[\"id\"]) {\n      console.log(donorInfo);\n      //   if (donorInfo[\"donors\"]) {\n      //     if (!donorInfo.donors.length) {\n      //       router.push(\"/login\");\n      //     } else {\n      dispatch({\n        type: \"LOGIN\",\n        payload: donorInfo.donors[0],\n      });\n      router.push(\"/account\");\n      //     }\n      //   } else {\n      //     router.push(\"/login\");\n      //   }\n\n      // router.push(\"/\");\n    }\n    if (organizationInfo && !user[\"id\"]) {\n      console.log(organizationInfo);\n      //   if (organizationInfo[\"organizations\"]) {\n      //     if (!organizationInfo.organizations.length) {\n      //       router.push(\"/login\");\n      //     } else {\n      //       console.log(organizationInfo);\n      dispatch({\n        type: \"LOGIN\",\n        payload: organizationInfo.organizations[0],\n      });\n      router.push(\"/account_o\");\n      //     }\n      //   } else {\n      //     router.push(\"/login\");\n      //   }\n\n      // router.push(\"/\");\n    }\n  }, [user, data, donorInfo, organizationInfo, token]);\n\n  return <div>{props.childeren}</div>;\n}\n"]},"metadata":{},"sourceType":"module"}